# 趋势科技 GandCrab 勒索软件案例

> 2019年中国农历年，当大家还都沉浸在新年的快乐中时，一种新型勒索软件（GandCrab v5.1）正在潜伏并即将在业界掀起一场新的风暴。

时间定格在2019年2月16日的一个午后，趋势科技工程师T正在家中陪伴家人，突然一阵急促的电话铃声响起。

“喂，是T吗？”，电话那头传来了T的上司L急促的声音。

“上司一般不会在周末打电话打扰职员的”，T心里想。“一定是遇到了不得了的事情”。

“是我，发生了什么事？”，T急忙询问L。

“你快看一下邮件，一种新的勒索软件爆发了。”

T急忙打开电脑，一封邮件跳入了T的目光，标题中的“Important”用红色字体凸显出来，使得这封邮件显得格外的与众不同。

T的心已经提了起来，“这封邮件内容一定很爆炸”，随即点开了邮件。

邮件格式非常正式，“5000台机器被锁死，其中有工作站也有服务器；客户无奈只能给黑客付款，优先解锁一批关键机器；客户获得了一组解密工具并请求趋势科技开发解密工具；客户拒绝在客户的环境中收集信息”。T在心中快速的总结信息。

“看来我们必须接下这个Case，根据目前收集到的信息和资料，我们需要尽快给支持团队一个结论。”，L在电话那端说。

“是的，目前我们收集到了病毒样本，黑客的解密工具。我想我可以开始工作，但是这需要一些时间，你知道的。”

“OK，开始吧，一旦有进展立刻告诉我。”

T立刻展开工作，他首先打开虚拟机（*作为一名专业的病毒分析专家，他有很多用于病毒分析的工具，但是首先必须确保病毒不会污染工作环境，因此在虚拟机中运行病毒是隔离危险的必要手段。*）运行病毒，并尝试用客户已经购买的解密工具解密准备好的测试文件，但是失败了。

“黑客很聪明”，T心想：“也许每一台设备都需要对应一个解密工具”。

“我记得Support提供了一批客户机器上文件，这些文件都被加密了。也许我可以在这些文件中找一找线索”，T一遍想一遍打开了Support提供的数据，并且他发现了一个线索。

`---BEGIN GANDCRAB KEY---
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
---END GANDCRAB KEY---`

看起来每一台设备会对应这样一个文件，既然客户购买的解密工具能够解锁一部分设备的数据，那解密工具应该包含了解密数据所需要的全部算法。 

“我应该从解密工具入手。”

T收到的解密工具一共有8个，虽然8个工具的哈希值并不一样，但是它们却具有相同的Size。基于经验，T判断这8个工具是相同的解密算法，差异的部分可能就是解密需要的Key。


